<!doctype html>
<html lang="pt-BR" data-theme="system">

<head>
  <script src="http://localhost:8097"></script>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="description" content="Planner do Caos — app de planejamento mágico + dark academia." />
  <meta name="color-scheme" content="light dark" />

  <!-- Theme-color dinâmico por mídia (chrome/android) -->
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#faf9fb" />
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#0b0a10" />

  <title>Planner do Caos</title>

  <!-- Fonte minimalista e elegante (Inter). Se preferir outra, eu troco nas configs -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  
  <!-- Reset mínimo + variáveis de cor do brand para fallback (Tailwind vai usar tokens) -->
  <style>
    :root {
      /* Paleta — ajuste fino no tailwind.config depois */
      --pc-bg: #faf9fb;
      /* neutro claro */
      --pc-surface: #ffffff;
      /* superfícies cards/modais light */
      --pc-text: #0e0c14;
      /* texto light */
      --pc-muted: #6b6b76;

      --pc-bg-dark: #0b0a10;
      /* neutro escuro */
      --pc-surface-dark: #12101a;
      /* superfícies cards/modais dark */
      --pc-text-dark: #ededf6;
      /* texto dark */
      --pc-muted-dark: #9aa0a6;

      --pc-primary: #6c45d3;
      /* roxo principal */
      --pc-primary-600: #5a37b8;
      --pc-gold: #d4af37;
      /* dourado/acento */
      --pc-border: #e7e4ec;
      --pc-border-dark: #272433;

      --pc-overlay: rgba(10, 8, 16, 1);
      /* overlay 100% opaco p/ modal */
      --pc-shadow: 0 10px 30px rgba(10, 8, 16, 0.12);
      /* sombra suave neutra */
      --pc-shadow-strong: 0 20px 60px rgba(10, 8, 16, 0.22);

      --pc-radius: 16px;
      /* 2xl por padrão */
      --pc-radius-sm: 10px;
      --pc-radius-lg: 22px;

      --pc-z-toast: 1000;
      --pc-z-modal: 1100;
      --pc-z-overlay: 1090;
      --pc-z-popover: 1050;
    }

    @media (prefers-color-scheme: dark) {
      :root {
        color-scheme: dark;
      }
    }

    html,
    body {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background: var(--pc-bg);
      color: var(--pc-text);
    }

    /* Splash mínimo enquanto o app hidrata */
    .pc-splash {
      display: grid;
      place-items: center;
      height: 100dvh;
      background:
        radial-gradient(60% 60% at 50% 0%, rgba(108, 69, 211, 0.08), transparent 60%),
        radial-gradient(40% 40% at 80% 20%, rgba(212, 175, 55, 0.08), transparent 60%),
        var(--pc-bg);
    }

    .pc-card {
      background: var(--pc-surface);
      border: 1px solid var(--pc-border);
      border-radius: var(--pc-radius);
      padding: 24px 20px;
      box-shadow: var(--pc-shadow);
      display: grid;
      gap: 8px;
      min-width: min(440px, 92vw);
      justify-items: center;
    }

    .pc-logo {
      font-weight: 700;
      letter-spacing: 0.2px;
      display: inline-grid;
      place-items: center;
      gap: 6px;
    }

    .pc-logo-mark {
      width: 28px;
      height: 28px;
      border-radius: 8px;
      background: conic-gradient(from 220deg, var(--pc-primary), var(--pc-gold), var(--pc-primary));
      box-shadow: 0 2px 10px rgba(108, 69, 211, 0.35);
    }

    .pc-sub {
      font-size: 14px;
      color: var(--pc-muted);
    }

    .pc-spinner {
      width: 18px;
      height: 18px;
      border-radius: 50%;
      border: 2px solid rgba(108, 69, 211, 0.25);
      border-top-color: var(--pc-primary);
      animation: pc-spin 0.9s linear infinite;
      margin-top: 4px;
    }

    @keyframes pc-spin {
      to {
        transform: rotate(360deg);
      }
    }

    /* dark mode base (até o app hidratar e setar classe) */
    @media (prefers-color-scheme: dark) {
      html:not(.force-light) body {
        background: var(--pc-bg-dark);
        color: var(--pc-text-dark);
      }

      html:not(.force-light) .pc-card {
        background: var(--pc-surface-dark);
        border-color: var(--pc-border-dark);
        box-shadow: var(--pc-shadow);
      }

      html:not(.force-light) .pc-sub {
        color: var(--pc-muted-dark);
      }
    }

    /* Portais: stacking contexts garantidos para não ficar “atrás” de nada */
    #pc-overlay-root {
      position: fixed;
      inset: 0;
      z-index: var(--pc-z-overlay);
      pointer-events: none;
    }

    #pc-modal-root {
      position: fixed;
      inset: 0;
      z-index: var(--pc-z-modal);
    }

    #pc-toast-root {
      position: fixed;
      inset: 0;
      z-index: var(--pc-z-toast);
      pointer-events: none;
    }

    #pc-popover-root {
      position: fixed;
      inset: 0;
      z-index: var(--pc-z-popover);
      pointer-events: none;
    }
  </style>

  <!-- Script de tema (system/default) + preferência salva -->
  <script>
    (function () {
        try {
          const saved = localStorage.getItem("pc-theme"); // "light" | "dark" | "system"
          const root = document.documentElement;
          const apply = (mode) => {
            root.classList.remove("force-light","force-dark");
            if (mode === "light") root.classList.add("force-light");
            if (mode === "dark") root.classList.add("force-dark");
            root.setAttribute("data-theme", mode || "system");
          };
          if (saved) apply(saved);
          else apply("system");
          // Atualiza se o usuário mudar o esquema do SO
          matchMedia("(prefers-color-scheme: dark)").addEventListener("change", () => {
            const cur = localStorage.getItem("pc-theme") || "system";
            apply(cur);
          });
        } catch (e) {}
      })();
  </script>
</head>

<body>
  <noscript>Este app precisa de JavaScript habilitado.</noscript>

  <!-- Splash enquanto React carrega -->
  <div id="pc-splash" class="pc-splash">
    <div class="pc-card" role="status" aria-live="polite" aria-label="Carregando Planner do Caos">
      <div class="pc-logo">
        <span class="pc-logo-mark" aria-hidden="true"></span>
        <span>Planner do Caos</span>
      </div>
      <div class="pc-sub">Carregando seu dashboard mágico…</div>
      <div class="pc-spinner" aria-hidden="true"></div>
    </div>
  </div>

  <!-- Raiz do app React -->
  <div id="root"></div>

  <!-- Portais: garantem modal/toast/popover SEM bugs de z-index/stacking -->
  <div id="pc-overlay-root" aria-hidden="true"></div>
  <div id="pc-modal-root"></div>
  <div id="pc-toast-root" aria-live="polite" aria-atomic="true"></div>
  <div id="pc-popover-root" aria-hidden="true"></div>

  <!-- Entrada Vite/React -->
  <script type="module" src="/src/main.jsx"></script>

  <!-- Remove splash quando o app estiver pronto (o app pode chamar isso também) -->
  <script>
    window.__pc_ready__ = function () {
        const s = document.getElementById("pc-splash");
        if (s && s.parentNode) s.parentNode.removeChild(s);
      };
      // Fallback: se o app demorar demais, some após 6s para não travar UX.
      setTimeout(() => {
        if (window.__pc_ready__) window.__pc_ready__();
      }, 6000);
  </script>

  <script>
    // hide splash/overlay after 2s to allow app to mount; adjust timeout as needed
    setTimeout(() => {
      document.querySelectorAll('#pc-splash, .pc-splash, #pc-overlay-root, #pc-modal-root, #pc-popover-root')
        .forEach(el => { if (el) { el.style.display = 'none'; el.style.pointerEvents = 'none'; } });
      document.body.style.pointerEvents = 'auto';
    }, 2000);
  </script>
</body>

</html>